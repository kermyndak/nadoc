<?xml version='1.0' encoding='utf-8'?>
<unattend xmlns="urn:schemas-microsoft-com:unattend">

<!-- Проход 1 ==================================== -->
 
    <settings pass="windowsPE" wasPassProcessed="true">
        
        <!-- Установка языковых параметров для интерфейса развертывания. Языков ввода для раскладки клавиатуры 'InputLocale' минимум 2шт! -->
        <component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <SetupUILanguage>
                <UILanguage>ru-RU</UILanguage>
            </SetupUILanguage>
            <SystemLocale>ru-RU</SystemLocale>
            <UILanguage>ru-RU</UILanguage>
            <UserLocale>ru-RU</UserLocale>
            <InputLocale>ru-RU; en-US</InputLocale>
        </component>
        <component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <SetupUILanguage>
                <UILanguage>ru-RU</UILanguage>
            </SetupUILanguage>
            <SystemLocale>ru-RU</SystemLocale>
            <UILanguage>ru-RU</UILanguage>
            <UserLocale>ru-RU</UserLocale>
            <InputLocale>ru-RU; en-US</InputLocale>
        </component>

       
        <component name="Microsoft-Windows-Setup" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            
            <!-- Скрыть окно Соглашение с EULA в начале развёртывания, согласившись с ним -->
            <UserData>
                <AcceptEula>true</AcceptEula>
            </UserData>
            
            <!-- Скрыть окно выбора индекса из образа для развёртывания, выбрав индекс 1 -->
            <ImageInstall>
                <OSImage>
                    <InstallFrom>
                        <MetaData wcm:action="add">
                            <Key>/IMAGE/INDEX</Key>
                            <Value>1</Value>
                        </MetaData>
                    </InstallFrom>
                </OSImage>
            </ImageInstall>
            
            <!-- Всегда отображать окно разбивки диска -->
            <DiskConfiguration>
                <WillShowUI>Always</WillShowUI>
            </DiskConfiguration>
            
        </component>
        <component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            
            <!-- Скрыть окно Соглашение с EULA в начале развёртывания, согласившись с ним -->
            <UserData>
                <AcceptEula>true</AcceptEula>
            </UserData>
            
            <!-- Скрыть окно выбора индекса из образа для развёртывания, выбрав индекс 1 -->
            <ImageInstall>
                <OSImage>
                    <InstallFrom>
                        <MetaData wcm:action="add">
                            <Key>/IMAGE/INDEX</Key>
                            <Value>1</Value>
                        </MetaData>
                    </InstallFrom>
                </OSImage>
            </ImageInstall>
            
            <!-- Всегда отображать окно разбивки диска -->
            <DiskConfiguration>
                <WillShowUI>Always</WillShowUI>
            </DiskConfiguration>
            
        </component>

    </settings> <!-- Проход 1 конец ======= -->

<!-- Проход 4 ==================================== -->

    <settings pass="specialize" wasPassProcessed="true">

        <!-- Пропуск окна указанием Региона, Имя компьютера и GVLK ключ (LTSC 2019) для установки Системы. Получить список всех допустимых регионов можно в cmd: tzutil /l -->
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <TimeZone>Russian Standard Time</TimeZone>
            <ComputerName>Computer</ComputerName>
            <ProductKey>*SENSITIVE*DATA*DELETED*</ProductKey>
        </component>
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <TimeZone>Russian Standard Time</TimeZone>
            <ComputerName>Computer</ComputerName>
            <ProductKey>*SENSITIVE*DATA*DELETED*</ProductKey>
        </component>

    </settings>  <!-- Проход 4 конец ======= -->

<!-- Проход 7 ==================================== -->

    <settings pass="oobeSystem" wasPassProcessed="true">
        
        <!-- Установка языковых параметров для Системы по умолчанию. Языков ввода для раскладки клавиатуры 'InputLocale' минимум 2шт! -->
        <component name="Microsoft-Windows-International-Core" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <!-- Пропустить окно Основы: Выбор региона и раскладки клавиатуры -->
            <UserLocale>ru-RU</UserLocale>
            <UILanguage>ru-RU</UILanguage>
            <SystemLocale>ru-RU</SystemLocale>
            <InputLocale>ru-RU; en-US</InputLocale>
        </component>
        <component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <!-- Пропустить окно Основы: Выбор региона и раскладки клавиатуры -->
            <UserLocale>ru-RU</UserLocale>
            <UILanguage>ru-RU</UILanguage>
            <SystemLocale>ru-RU</SystemLocale>
            <InputLocale>ru-RU; en-US</InputLocale>
        </component>

        <!-- Выполнение действий на последнем этапе развертывания. Указание параметров региона, телеметрии и запуска батника -->
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="x86" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            
            <!-- Пропустить окно Основы: Выбор региона и раскладки клавиатуры -->
            <TimeZone>Russian Standard Time</TimeZone>

            <OOBE>
                <!-- Пропуск окон предварительной настройки системы перед первым стартом -->
                <HideEULAPage>true</HideEULAPage>
                <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
                <HideOnlineAccountScreens>true</HideOnlineAccountScreens>

                <!-- Пропустить окно Сеть: Подключение к любой сети, для обновления системы во время развёртывания -->
                <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>

                <!-- Пропустить окно Службы: Экспресс настроек (телеметрия и т.д.), Выключив все переключатели в этом окне -->
                <ProtectYourPC>3</ProtectYourPC>
                
                <!-- Не включать контент для Retail Demo -->
                <UnattendEnableRetailDemo>false</UnattendEnableRetailDemo>
                
                <!-- Пропуск последнего окна настроек Шкалы времени и журнала буфера обмена делается через отключение в SetupComplete.cmd -->
            </OOBE>
          
            <!-- Добавление ярлыков Проводника и IE на ТаскБар (Для такого действия ярлык должен существовать по этому пути, в данном случае он есть.) -->
            <TaskbarLinks>
                <Link0>%UserProfile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\System Tools\File Explorer.lnk</Link0>
                <Link1>%UserProfile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Accessories\Internet Explorer.lnk</Link1>
            </TaskbarLinks>

        </component>
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            
            <!-- Пропустить окно Основы: Выбор региона и раскладки клавиатуры -->
            <TimeZone>Russian Standard Time</TimeZone>

            <OOBE>
                <!-- Пропуск окон предварительной настройки системы перед первым стартом -->
                <HideEULAPage>true</HideEULAPage>
                <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
                <HideOnlineAccountScreens>true</HideOnlineAccountScreens>

                <!-- Пропустить окно Сеть: Подключение к любой сети, для обновления системы во время развёртывания -->
                <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>

                <!-- Пропустить окно Службы: Экспресс настроек (телеметрия и т.д.), Выключив все переключатели в этом окне -->
                <ProtectYourPC>3</ProtectYourPC>
                
                <!-- Не включать контент для Retail Demo -->
                <UnattendEnableRetailDemo>false</UnattendEnableRetailDemo>
                
                <!-- Пропуск последнего окна настроек Шкалы времени и журнала буфера обмена делается через отключение в SetupComplete.cmd -->
            </OOBE>

            <!-- Добавление ярлыков Проводника и IE на ТаскБар (Для такого действия ярлык должен существовать по этому пути, в данном случае он есть.) -->
            <TaskbarLinks>
                <Link0>%UserProfile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\System Tools\File Explorer.lnk</Link0>
                <Link1>%UserProfile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Accessories\Internet Explorer.lnk</Link1>
            </TaskbarLinks>

        </component>

    </settings>  <!-- Проход 7 конец ======= -->

</unattend>